{"version":3,"file":"build-routes.js","sources":["core/utils/controller/build-routes.ts"],"sourceRoot":"/","sourcesContent":["/* eslint-disable @typescript-eslint/restrict-template-expressions */\nimport { FastifyInstance } from 'fastify';\nimport { SYMBOL_CONTROLLER } from '../decorators/controller/symbols';\nimport registerController from './register-controller';\n// import { ICreateController } from '../decorators/controller/types';\nimport createContainer from '../decorators/container';\n\nexport default function buildRoutes(\n  app: FastifyInstance,\n  controllers: any[]\n) {\n  controllers.forEach((controller) => {\n    const controllerInstance = createContainer().get<typeof controller>(controller.name);\n\n    let path: string;\n    if (Reflect.hasMetadata(SYMBOL_CONTROLLER, controllerInstance.constructor)) {\n      path = Reflect.getMetadata(SYMBOL_CONTROLLER, controllerInstance.constructor);\n    } else {\n      const t = /^(.+?)(Controller)?$/.exec(controllerInstance.constructor.name);\n      if (t && t?.length > 0) {\n        const [, p] = t;\n        path = `/${p}`;\n      } else {\n        path = `/${controller.name}`;\n      }\n    }\n    path = path[0].toLocaleLowerCase() + path.substring(1).replace(/[A-Z]/g, (i) => `-${i.toLowerCase()}`);\n    registerController(path, controllerInstance, app);\n  });\n}\n"],"names":[],"mappings":";;;;;;;AAEA,8DAAqE;AACrE,gFAAuD;AACvD,sEAAsE;AACtE,wEAAsD;AAEtD,SAAwB,WAAW,CACjC,GAAoB,EACpB,WAAkB;IAElB,WAAW,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,EAAE;QACjC,MAAM,kBAAkB,GAAG,IAAA,mBAAe,GAAE,CAAC,GAAG,CAAoB,UAAU,CAAC,IAAI,CAAC,CAAC;QAErF,IAAI,IAAY,CAAC;QACjB,IAAI,OAAO,CAAC,WAAW,CAAC,2BAAiB,EAAE,kBAAkB,CAAC,WAAW,CAAC,EAAE,CAAC;YAC3E,IAAI,GAAG,OAAO,CAAC,WAAW,CAAC,2BAAiB,EAAE,kBAAkB,CAAC,WAAW,CAAC,CAAC;QAChF,CAAC;aAAM,CAAC;YACN,MAAM,CAAC,GAAG,sBAAsB,CAAC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC3E,IAAI,CAAC,IAAI,CAAC,EAAE,MAAM,GAAG,CAAC,EAAE,CAAC;gBACvB,MAAM,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;gBAChB,IAAI,GAAG,IAAI,CAAC,EAAE,CAAC;YACjB,CAAC;iBAAM,CAAC;gBACN,IAAI,GAAG,IAAI,UAAU,CAAC,IAAI,EAAE,CAAC;YAC/B,CAAC;QACH,CAAC;QACD,IAAI,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,iBAAiB,EAAE,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QACvG,IAAA,6BAAkB,EAAC,IAAI,EAAE,kBAAkB,EAAE,GAAG,CAAC,CAAC;IACpD,CAAC,CAAC,CAAC;AACL,CAAC;AAtBD,8BAsBC","debug_id":"e2f2ff38-56d9-5b58-ab3e-95f48d551df6"}