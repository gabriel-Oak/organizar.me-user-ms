{"version":3,"file":"user.js","sources":["core/features/user/entities/user.ts"],"sourceRoot":"/","sourcesContent":["import { compare, hash } from 'bcryptjs';\nimport { JWT_SECRET } from '../../../utils/constants';\n\nexport interface UserProps {\n  id?: string;\n  name: string;\n  email: string;\n  password?: string;\n}\n\nexport default class User implements UserProps {\n  id?: string;\n  name!: string;\n  email!: string;\n  password?: string;\n\n  constructor({ id, name, email, password }: UserProps) {\n    Object.assign(this, {\n      id,\n      name,\n      email,\n      password\n    });\n  }\n\n  async comparePasswords(candidatePassword: string) {\n    if (!this.password) return false;\n    return await compare(candidatePassword + JWT_SECRET, this.password);\n  }\n\n  async hashPassword() {\n    if (this.password &&\n      !this.password.includes('$2a$12$') &&\n      this.password.length < 60\n    ) {\n      this.password = await hash(this.password + JWT_SECRET, 12);\n    }\n  }\n}\n"],"names":[],"mappings":";;;;AAAA,uCAAyC;AACzC,wDAAsD;AAStD,MAAqB,IAAI;IAMvB,YAAY,EAAE,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE,QAAQ,EAAa;QAClD,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE;YAClB,EAAE;YACF,IAAI;YACJ,KAAK;YACL,QAAQ;SACT,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,gBAAgB,CAAC,iBAAyB;QAC9C,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE,OAAO,KAAK,CAAC;QACjC,OAAO,MAAM,IAAA,kBAAO,EAAC,iBAAiB,GAAG,sBAAU,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;IACtE,CAAC;IAED,KAAK,CAAC,YAAY;QAChB,IAAI,IAAI,CAAC,QAAQ;YACf,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,SAAS,CAAC;YAClC,IAAI,CAAC,QAAQ,CAAC,MAAM,GAAG,EAAE,EACzB,CAAC;YACD,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAA,eAAI,EAAC,IAAI,CAAC,QAAQ,GAAG,sBAAU,EAAE,EAAE,CAAC,CAAC;QAC7D,CAAC;IACH,CAAC;CACF;AA5BD,uBA4BC","debug_id":"19cc2618-b279-5aba-ae49-597fd327288a"}