{"version":3,"file":"authenticate-user.js","sources":["core/features/user/usecases/authenticate-user/authenticate-user.ts"],"sourceRoot":"/","sourcesContent":["import { inject } from 'inversify';\nimport Injectable from '../../../../utils/decorators/injectable';\nimport { Left, Right } from '../../../../utils/types';\nimport { IInternalUserDatasource } from '../../datasources/internal-datasource/types';\nimport { AuthenticateInvalidError, AuthenticateUserNotFoundError, AuthenticateUserWrongPasswordError, IAuthenticateUserUsecase, LoginPayload } from './types';\n\n@Injectable('IAuthenticateUserUsecase')\nexport default class AuthenticateUserUsecase implements IAuthenticateUserUsecase {\n  constructor(\n    @inject('IInternalUserDatasource')\n    private readonly userUsecase: IInternalUserDatasource\n  ) { }\n\n  async execute(payload: LoginPayload) {\n    if (!payload?.email || !payload?.password) return new Left(new AuthenticateInvalidError());\n\n    const userResult = await this.userUsecase.findByEmail(payload.email);\n    if (userResult.isError) return userResult;\n\n    const { success: user } = userResult;\n    if (!user) return new Left(new AuthenticateUserNotFoundError());\n\n    if (await user.comparePasswords(payload.password)) {\n      user.password = undefined;\n      return new Right(user)\n    }\n    return new Left(new AuthenticateUserWrongPasswordError());\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA,yCAAmC;AACnC,yFAAiE;AACjE,mDAAsD;AAEtD,mCAA8J;AAG/I,IAAM,uBAAuB,GAA7B,MAAM,uBAAuB;IAC1C,YAEmB,WAAoC;QAApC,gBAAW,GAAX,WAAW,CAAyB;IACnD,CAAC;IAEL,KAAK,CAAC,OAAO,CAAC,OAAqB;QACjC,IAAI,CAAC,OAAO,EAAE,KAAK,IAAI,CAAC,OAAO,EAAE,QAAQ;YAAE,OAAO,IAAI,YAAI,CAAC,IAAI,gCAAwB,EAAE,CAAC,CAAC;QAE3F,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACrE,IAAI,UAAU,CAAC,OAAO;YAAE,OAAO,UAAU,CAAC;QAE1C,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,UAAU,CAAC;QACrC,IAAI,CAAC,IAAI;YAAE,OAAO,IAAI,YAAI,CAAC,IAAI,qCAA6B,EAAE,CAAC,CAAC;QAEhE,IAAI,MAAM,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC;YAClD,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC;YAC1B,OAAO,IAAI,aAAK,CAAC,IAAI,CAAC,CAAA;QACxB,CAAC;QACD,OAAO,IAAI,YAAI,CAAC,IAAI,0CAAkC,EAAE,CAAC,CAAC;IAC5D,CAAC;CACF,CAAA;AArBoB,uBAAuB;IAD3C,IAAA,oBAAU,EAAC,0BAA0B,CAAC;IAGlC,WAAA,IAAA,kBAAM,EAAC,yBAAyB,CAAC,CAAA;;GAFjB,uBAAuB,CAqB3C;kBArBoB,uBAAuB","debug_id":"a1078b76-e75b-596b-acea-25db51eca427"}