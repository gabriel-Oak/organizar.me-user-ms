#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ§ª Executando testes ğŸ§ª"
npm run coverage
status=$?

if [ "$status" = 0 ] ; then
    echo -e "\e[32mğŸ˜ Todos os testes passaram ğŸ˜\e[0m"
else
    echo -e "\e[31mğŸ˜¢ Erro, alguns testes falharam ğŸ˜¢\e[0m"
    #Exit
    exit 1
fi

echo "ğŸ” Executando eslint ğŸ”"
npx lint-staged
status=$?

if [ "$status" = 0 ] ; then
    echo -e "\e[32mğŸ¤“ Nenhum problema encontrado ğŸ¤“\e[0m"
else
    echo -e "\e[31mğŸ˜« Eslint encontrou problemas que nÃ£o conseguiu resolver ğŸ˜«\e[0m"
    exit 1
fi

echo "ğŸ¤“ Buildando a aplicaÃ§Ã£o ğŸ¤“"
npm run build
status=$?
git add public/ --force

if [ "$status" = 0 ] ; then
    echo -e "\e[32mğŸ˜ Build executado com sucesso! ğŸ˜\e[0m"
else
    echo -e "\e[31mğŸ˜¢ Erro, tivemos algum problema ğŸ˜¢\e[0m"
    #Exit
    exit 1
fi

exit 0